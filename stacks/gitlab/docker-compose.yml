---
name: gitlab
services:
  gitlab:
    hostname: gitlab.${LOCAL_DOMAIN}
    domainname: ${LOCAL_DOMAIN}
    image: 'gitlab/gitlab-ce:latest'
    container_name: gitlab
    restart: always
    environment:
      GITLAB_ROOT_EMAIL: "${GITLAB_USER}@${LOCAL_DOMAIN}"
      GITLAB_ROOT_PASSWORD: "${GITLAB_PASSWORD}"
    volumes:
      - config:/etc/gitlab
      - data:/var/opt/gitlab
      - log:/var/log/gitlab
    dns:
      - ${NS1_IP}
      - ${NS2_IP}
    dns_search: ${LOCAL_DOMAIN}
    networks:
      net1:
        ipv4_address: ${THIS_IP}

volumes:
  config:
  data:
  log:

networks:
  net1:
    external: true
    name: ${LAN_NAME}
